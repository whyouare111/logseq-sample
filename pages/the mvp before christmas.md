---
title: The MVP Before Christmas
---

## 来源 https://dev.mirror.xyz/J1RD6UQQbdmpCoXvWnuGIfe7WmrbVRdff5EqegO1RjI
### 对应的 Arweave 存储 https://4y3qyvn34whoszbepxgnssldfclem5uthkb34jj4amysp67pl6ta.arweave.net/5jcMVbvljulkJH3M2UljKJZGdpM6g74lPAMxJ_vvX6Y
## 如何构建一个 Web3 原生的写作平台
### 首先面临的一个挑战是，从 web3 的角度思考如何搭建平台。以下是 web3 的游戏规则（ via negativa 式，即 “它不是什么/它不应该如何”）
#### 1. 帖子内容不应该是中心化的
##### 使用 Arweave 来存储用户内容
###### 数据永久存储，只需在上传时支付一次性费用
###### 上传到 Arweave 的数据包括检索出版物的所有条目 （包括任何修改）和验证作者身份真实性所需的所有信息。
##### 计划发布协议规范和开源工具
###### 提升检索和验证的使用体验
##### 能够轻易地从 ^^Mirror^^ 中迁移出去
#### 2. 阅读体验不需要信赖  ^^Mirror^^
##### 所有条目用用户的签名密钥
###### 不是以太坊的密钥对，不包含任何直接的经济价值
####### 也就是说这个密钥是公开的形式也不会直接危害到钱包里的各种数字资产
##### 签名、签名过的摘要、签名的内容上传 Arweave
###### `authorship.signature`
###### `content.digest`
###### `content.body`
##### 签名密钥本身会被放入一个申明作者权利的消息中，然后由作者的以太坊地址进行签名。
###### 这些信息也会上传至 Arweave
####### 对应每个条目和更新。
###### `authorship.signingKeyMessage`
#### 3. ^^Mirror^^不应拥有作家的域名
##### [[ENS]]
###### 作家通过销毁一个 [[$WRITE]] Token 来声明对域名的所有权
####### [[$WRITE]] 用投票的方式来邀请 [[Twitter]] 用户
#### 4. 作家不需要连接他们的钱包并签署他们所写的一切
##### 我们不用很麻烦很累就能 <del>成佛</del> 写文章
##### 特别是要能往能做更多细粒度的动作发展，如允许点赞和评论，如果每做一个动作都要硬钱包签名根本是劝退
###### 个人补充：这方面倒是可以参照一下 [[ActivityPub]] 的做法，跨服务器是怎么推送点赞、转嘟、评论信息，并可以在 `Activity` 消息里带上签名验证来源
#### 5. ^^Mirror^^不应尝试在浏览器端存储以太坊私钥
##### 直接在浏览器中存储用户的Ethereum私钥被认为是异端，我通常会同意这一点。严格来说，并不是说你不能用这种方式来构建一个有用的webapp（Dharma就做过一段时间），但随着时间的推移，安全负担会越来越重。这主要是因为没有办法使用原生的web-crypto库制作和存储不可提取的Ethereum私钥，它不支持同样的ECDSA曲线。我不知道这在未来会如何发展，但现在，我想说这是要避免的。
##### 我们通过两种方式来避免这种安全负担
###### 1. 通过使用与Ethereum实现不同的签名方案（我们使用的是NIST曲线P-256），因此使得密钥根本不可能 "具有经济价值"，完全回避了一个重大问题。在最严重的威胁模型下（如被盗电脑），最坏的情况是欺诈性的作者身份。
####### 个人补充：盗用电脑的人拿到这个签名密钥就可以在发文的时候用这个来声称他是你
###### 2. 通过使用不可提取的属性生成密钥，并将其存储在 IndexDB 中。这意味着根本无法导出私钥--私钥只能用于在加载的网页上签署内容，IndexDB防止在mirror.xyz之外的任何网站上加载。
####### 不可提取，那就只能通过生成密钥的浏览器、在指定的网站上加载
####### 可以对照上面的被盗电脑来理解。这个电脑本身是公共电脑那当然没办法了，相当于你自己想让多人共用这个“笔名”
###### 我邀请大家对这种方法进行批评。我不是一个密码学专家，我们只是想在一个安全和可用的平台上做出诚实的努力，这个平台不受web2的传统标准的影响，而这些标准一直让我们失望。如果你想更详细地解释这个方法，我们很快就会发布一个关于这个主题的更完整的specRFC。
####### 个人补充：可以说这个方案是 mirror.xyz 的作者们想出来的，在他知识体系内这个方案足够安全，但因为不是密码学专家，比如可能有意想不到的攻击法能得到IndexDB本身？
#### 6. 写作不应该太贵 （对 ^^Mirror^^ 或作家来说都是）
##### 由 Arweave 方案解决了。非常便宜（至少在当前是？）
###### 按照目前(2020-12-21)的汇率，每篇博文的成本约为0.00005AR，约合0.00015美元。
#### 7. 奖励： 不用邮箱-密码注册
##### 由于我们有签名密钥和基于签名的身份验证模型，我们不需要有登录会话，我们也没有任何东西可以通过电子邮件恢复。在未来，可能会允许电子邮件通知和电子邮件摘要，但现在，有趣的是，使用Mirror不需要电子邮件确认。这是Zerion和Zapper等应用使用的加密原生方式，也是网络上未来的认证方式。
###### 个人补充：如果想做 [[Substack]] 那样的 Newsletter 服务, 关联一个邮箱地址还是有必要的——不过依然没必要用来登录
##### 入驻时增加事务确认。会持续改进，以后会变得更顺畅
###### 个人补充：能看出来 Mirror 团队对这种和传统使用体验不同的部分有花心思去思考想替代方案
### 架构图大致是这样
#### [架构图](https://images.mirror-media.xyz/publication-images/4ad92c52-5226-40c1-b654-4bbfe905c278.jpeg){:height 472, :width 604}
### 上主网前的测试
#### Mirror 仍处于早期阶段，我们正在使用 Ethereum testnet 基础设施来探索我们的想法。这让我们可以非常便宜地运行复杂的协议流程（如燃烧代币、部署合约和注册ENS域），并且确认时间很快。特别是，我们仍在探索我们的经济、命名和所有权协议的机制，随着需求的增长，我们将建立一个更复杂的系统。我们希望一旦我们知道将我们的早期写手迁移到这个更好的协议是可行和容易的，就会尽快部署到主网。
### 构建一个后端 API 作为 "协议网关"
#### 为了方便用户，让用户获得良好的读写体验，我们决定建立一个后端API，作为客户端和协议之间的 _网关_ 。这样我们就可以在发布到 Arweave 之前进行签名验证，为 Arweave 的发布内容付费，并缓存条目内容，以获得极快的响应时间。这使得我们能够拥有世界级的写作和阅读体验，同时还能实现内容去中心化的所有目标。
##### 个人补充
###### 在这个 协议网关的实现没有开源之前，这里可以说是 Mirror 的实现方案中最中心化的部分了
###### 也许可以称作 web 2.5
###### 优点是很多麻烦的细节都可以交给后端托管，也能检查输出内容是不是符合自己的期望（可以确认内容和签名），算是个不错的妥协
###### 中心化的部分主要在“写”的部分，而不是读的部分。
####### 即使 Mirror 不再提供服务，已经上传到 Arweave 上的现有文章的元数据依然可以通过 Arweave 取得，也就是说可以自己构建出独立站点
######## 事实上已经有了开源实现 https://github.com/m1guelpf/mirror-next
######### 用 Vercel 几乎可以做到一键部署
######### 支持 RSS Feed
#########
#### 在2021年构建这个后端API方面，可能有10多个可行的选择，可以选择在哪里部署代码，同样有很多有前途的语言来开发它。挑选早期的工具是很困难的! 我最终选择了一些在我的能力范围内很强的东西，而且对于我们团队的新工程师来说，也很容易学习。我还选择了我认为未来可扩展性和灵活性最大的路径，对我们来说，这意味着在AWS基础设施上用NodeJS构建我们的后端。然而，这个决定并不明显，我希望考虑到我们在未来一段时间内作为一个工程订单所要建立的能力。
##### 个人补充
###### 可以说开荒了很多东西。至少一些技术选型上面不用那么纠结了
###### 这个后端还是关系到现在的 mirror.xyz 会不会崩的，单点压力在这里
#### 在AWS上设置Web应用比使用Heroku或Vercel等抽象服务要耗费更多时间。像环境、数据库、安全组和部署都必须单独配置起来。不过从长远来看，它授予了更多的控制权，这对于加密应用来说是很有帮助的，有时会有非标准的顾虑。我花了大约2天的时间来设置这个基础设施--包括安全组、IAM账户、数据库、暂存和生产环境等。但从这里开始，我知道我的背后有世界上最好的基础设施，没有较新的、功能不全的服务的平台风险。
##### 个人补充
###### 也就是要操心传统的云服务器环境要操心的那些事。业务服务器、数据库、网关、负载均衡、安全什么的
###### 要提供生产级别的服务的话我也会选大云服务商吧
