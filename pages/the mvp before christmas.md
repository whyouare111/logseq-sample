---
title: The MVP Before Christmas
---

## 来源 https://dev.mirror.xyz/J1RD6UQQbdmpCoXvWnuGIfe7WmrbVRdff5EqegO1RjI
### 对应的 Arweave 存储 https://4y3qyvn34whoszbepxgnssldfclem5uthkb34jj4amysp67pl6ta.arweave.net/5jcMVbvljulkJH3M2UljKJZGdpM6g74lPAMxJ_vvX6Y
## **如何构建一个 Web3 原生的写作平台**
### 首先面临的一个挑战是，从 web3 的角度思考如何搭建平台。以下是 web3 的游戏规则（ via negativa 式，即 “它不是什么/它不应该如何”）
#### 1. 帖子内容不应该是中心化的
##### 使用 Arweave 来存储用户内容
###### 数据永久存储，只需在上传时支付一次性费用
###### 上传到 Arweave 的数据包括检索出版物的所有条目 （包括任何修改）和验证作者身份真实性所需的所有信息。
##### 计划发布协议规范和开源工具
###### 提升检索和验证的使用体验
##### 能够轻易地从 ^^Mirror^^ 中迁移出去
#### 2. 阅读体验不需要信赖  ^^Mirror^^
##### 所有条目用用户的签名密钥
###### 不是以太坊的密钥对，不包含任何直接的经济价值
####### 也就是说这个密钥是公开的形式也不会直接危害到钱包里的各种数字资产
##### 签名、签名过的摘要、签名的内容上传 Arweave
###### `authorship.signature`
###### `content.digest`
###### `content.body`
##### 签名密钥本身会被放入一个申明作者权利的消息中，然后由作者的以太坊地址进行签名。
###### 这些信息也会上传至 Arweave
####### 对应每个条目和更新。
###### `authorship.signingKeyMessage`
#### 3. ^^Mirror^^不应拥有作家的域名
##### [[ENS]]
###### 作家通过销毁一个 [[$WRITE]] Token 来声明对域名的所有权
####### [[$WRITE]] 用投票的方式来邀请 [[Twitter]] 用户
#### 4. 作家不需要连接他们的钱包并签署他们所写的一切
##### 我们不用很麻烦很累就能 <del>成佛</del> 写文章
##### 特别是要能往能做更多细粒度的动作发展，如允许点赞和评论，如果每做一个动作都要硬钱包签名根本是劝退
###### 个人补充：这方面倒是可以参照一下 [[ActivityPub]] 的做法，跨服务器是怎么推送点赞、转嘟、评论信息，并可以在 `Activity` 消息里带上签名验证来源
#### 5. ^^Mirror^^不应尝试在浏览器端存储以太坊私钥
##### 
> 直接在浏览器中存储用户的Ethereum私钥被认为是异端，我通常会同意这一点。严格来说，并不是说你不能用这种方式来构建一个有用的webapp（Dharma就做过一段时间），但随着时间的推移，安全负担会越来越重。这主要是因为没有办法使用原生的web-crypto库制作和存储不可提取的Ethereum私钥，它不支持同样的ECDSA曲线。我不知道这在未来会如何发展，但现在，我想说这是要避免的。
##### 
> 我们通过两种方式来避免这种安全负担
###### 
> 1. 通过使用与Ethereum实现不同的签名方案（我们使用的是NIST曲线P-256），因此使得密钥根本不可能 "具有经济价值"，完全回避了一个重大问题。在最严重的威胁模型下（如被盗电脑），最坏的情况是欺诈性的作者身份。
####### 个人补充：盗用电脑的人拿到这个签名密钥就可以在发文的时候用这个来声称他是你
###### 
> 2. 通过使用不可提取的属性生成密钥，并将其存储在 IndexDB 中。这意味着根本无法导出私钥--私钥只能用于在加载的网页上签署内容，IndexDB防止在mirror.xyz之外的任何网站上加载。
####### 不可提取，那就只能通过生成密钥的浏览器、在指定的网站上加载
####### 可以对照上面的被盗电脑来理解。这个电脑本身是公共电脑那当然没办法了，相当于你自己想让多人共用这个“笔名”
###### 
> 我邀请大家对这种方法进行批评。我不是一个密码学专家，我们只是想在一个安全和可用的平台上做出诚实的努力，这个平台不受web2的传统标准的影响，而这些标准一直让我们失望。如果你想更详细地解释这个方法，我们很快就会发布一个关于这个主题的更完整的specRFC。
####### 个人补充：可以说这个方案是 mirror.xyz 的作者们想出来的，在他知识体系内这个方案足够安全，但因为不是密码学专家，比如可能有意想不到的攻击法能得到IndexDB本身？
#### 6. 写作不应该太贵 （对 ^^Mirror^^ 或作家来说都是）
##### 由 Arweave 方案解决了。非常便宜（至少在当前是？）
###### 按照目前(2020-12-21)的汇率，每篇博文的成本约为0.00005AR，约合0.00015美元。
#### 7. 奖励： 不用邮箱-密码注册
##### 
> 由于我们有签名密钥和基于签名的身份验证模型，我们不需要有登录会话，我们也没有任何东西可以通过电子邮件恢复。在未来，可能会允许电子邮件通知和电子邮件摘要，但现在，有趣的是，使用Mirror不需要电子邮件确认。这是Zerion和Zapper等应用使用的加密原生方式，也是网络上未来的认证方式。
###### 个人补充：如果想做 [[Substack]] 那样的 Newsletter 服务, 关联一个邮箱地址还是有必要的——不过依然没必要用来登录
##### 入驻时增加事务确认。会持续改进，以后会变得更顺畅
###### 个人补充：能看出来 Mirror 团队对这种和传统使用体验不同的部分有花心思去思考想替代方案
### **架构图**
#### [架构图](https://images.mirror-media.xyz/publication-images/4ad92c52-5226-40c1-b654-4bbfe905c278.jpeg){:height 472, :width 604}
## **上主网前的测试**
### 
> Mirror 仍处于早期阶段，我们正在使用 Ethereum testnet 基础设施来探索我们的想法。这让我们可以非常便宜地运行复杂的协议流程（如燃烧代币、部署合约和注册ENS域），并且确认时间很快。特别是，我们仍在探索我们的经济、命名和所有权协议的机制，随着需求的增长，我们将建立一个更复杂的系统。我们希望一旦我们知道将我们的早期写手迁移到这个更好的协议是可行和容易的，就会尽快部署到主网。
## **构建一个后端 API 作为 "协议网关"**
### 
> 为了方便用户，让用户获得良好的读写体验，我们决定建立一个后端API，作为客户端和协议之间的 _网关_ 。这样我们就可以在发布到 Arweave 之前进行签名验证，为 Arweave 的发布内容付费，并缓存条目内容，以获得极快的响应时间。这使得我们能够拥有世界级的写作和阅读体验，同时还能实现内容去中心化的所有目标。
#### 个人补充
##### 在这个 协议网关的实现没有开源之前，这里可以说是 Mirror 的实现方案中最中心化的部分了
##### 也许可以称作 web 2.5
##### 优点是很多麻烦的细节都可以交给后端托管，也能检查输出内容是不是符合自己的期望（可以确认内容和签名），算是个不错的妥协
##### 中心化的部分主要在“写”的部分，而不是读的部分。
###### 即使 Mirror 不再提供服务，已经上传到 Arweave 上的现有文章的元数据依然可以通过 Arweave 取得，也就是说可以自己构建出独立站点
####### 事实上已经有了开源实现 https://github.com/m1guelpf/mirror-next
######## 用 Vercel 几乎可以做到一键部署
######## 支持 RSS Feed
######## 目前还是有用到 mirror 自身提供的 API，比如需要从钱包地址获取到 contributor, 还有 entries
######### 这点也许可以用 The Graph 等方案来进一步去中心化？
### 
> 在2021年构建这个后端API方面，可能有10多个可行的选择，可以选择在哪里部署代码，同样有很多有前途的语言来开发它。挑选早期的工具是很困难的! 我最终选择了一些在我的能力范围内很强的东西，而且对于我们团队的新工程师来说，也很容易学习。我还选择了我认为未来可扩展性和灵活性最大的路径，对我们来说，这意味着在AWS基础设施上用NodeJS构建我们的后端。然而，这个决定并不明显，我希望考虑到我们在未来一段时间内作为一个工程订单所要建立的能力。
#### 个人补充
##### 可以说开荒了很多东西。至少一些技术选型上面不用那么纠结了
##### 这个后端还是关系到现在的 mirror.xyz 会不会崩的，单点压力在这里
### 
> 在AWS上设置Web应用比使用Heroku或Vercel等抽象服务要耗费更多时间。像环境、数据库、安全组和部署都必须单独配置起来。不过从长远来看，它授予了更多的控制权，这对于加密应用来说是很有帮助的，有时会有非标准的顾虑。我花了大约2天的时间来设置这个基础设施--包括安全组、IAM账户、数据库、暂存和生产环境等。但从这里开始，我知道我的背后有世界上最好的基础设施，没有较新的、功能不全的服务的平台风险。我们通过AWS的RDS服务使用Postgres，VPC 和安全组用于 ElasticBeanstalk 和 RDS 之间的通信。我们的API端点使用了 **GraphQL with Apollo** 。
#### 个人补充
##### 也就是要操心传统的云服务器环境要操心的那些事。业务服务器、数据库、网关、负载均衡、安全什么的
##### 要提供生产级别的服务的话我也会选大云服务商吧
###### 过渡期可能会转变成多个可自部署的实例，激励人去搭建这样的服务
####### 这里又涉及到服务器是否安全的问题。如何判断实例是可信的？
######## [[Web of Trust]]
######## [[Social Token]] 到 [[DAO]] 的治理
######## [[Fediverse]] 生态的经验也许有帮助
######## 说白了还是把口碑上链
### 
> 我在这里要说明的是，在决定走这条路之前，我曾考虑过用Golang或Rust来写后端，并使用protobufs，因为加密签名需要严格的类型化来实现跨平台的正确验证。但如果我们走这条路，开发速度会慢很多。另一方面如果，从一开始就建立起 Rust的能力，可以让我们跟踪越来越多的有趣的 layer-2 集成（这似乎很有前途）。
#### 个人补充
##### 很好的技术选型示例。做 MVP 的时候还是要考虑当前团队的技术栈
##### 另一边考虑的是性能、安全、生态发展方向的事
##### 说不定还会考虑 DFinity 来把网关层也进一步去中心化
###### 要在合适的时间点做。一方面是足够成熟，另一方面也要考虑到经济模型是否可靠
###
> 我们的部署是通过Github工作流来处理的，这样每一次推送到我们的staging或main都会在Github上触发一个部署应用程序的操作。要明确的是，这里还有很多需要改进的地方--包括在测试套件通过时阻止部署，以及测量测试覆盖率。我们没有完整的集成测试，例如，针对构建的docker包含暴露的GraphQL端点的测试。
#### 个人补充
##### 持续集成、持续发布、测试方案
##### 应用了很多主流的方案
###### 唉？如果 Github 不能用了该怎么办？ Repo在自己手里有一份的话总是有开源替代的
## **构建博客的前端**
### 
> 我们决定在前端使用Vercel和NextJS，它具有通配符子域支持，以及对静态渲染内容的支持。到目前为止，这一点非常棒，因为我们得到了快速加载、良好缓存的内容，可以被社交媒体平台和搜索引擎等机器轻松读取。一般来说，它也是一个管理暂存环境、部署等的神奇产品。
#### 个人补充
##### 前端良好的生态在这里起到了很大的作用
## **哪些部分进展顺利？**
###
> 我们能够非常快速地推出MVP--我们的目标是在圣诞节前发货，直到12月才开始构建后端。所以总的来说，我们只花了几周的时间就构建了一个新颖的CMS，它使用公钥私钥签名来验证内容，在Postgres中存储数据，在Arweave上存储数据，在Ethereum上烧毁一个令牌来宣称ENS标签的所有权，验证该标签的所有权，对我们的签名模型进行迭代，等等。
### 具体的例子
####
>Trent的第一篇博文：https:/stateful.mirror.xyza151ee1decb2028a8bb48277f6928c6f38319c32601dc1da1ee82acfcad2e525
####
> 一个烧毁$WRITE令牌并声称有ENS域的事务：https:/rinkeby.etherscan. iotx0x29b9d13187a2db64b7d85f4ff5be739729b07404fd1f5fce79b3bba13da7530b
####
> 一个Arweave事务，永远存储 Linda 的帖子，以及证明作者身份的签名：https:/viewblock.ioarweavetxWvwsHyKCjfkLoKNbNSGfoV-vaWrJa2PMYB_c3wucXUA
###
> 回想过去一个月的时间，我们所能打造出来的一切，也是很累的! 而事实上，这基本上是工作的，是非常有趣和令人兴奋的。我很高兴我们也做了相当多的 "公开 "的工作，并有屏幕记录我们的入职会议。
#### 个人补充
##### 感觉是个不错的推进项目的方式
## **出了什么问题？**
###
> 由于同时应对如此多的挑战，有时感觉有大量的重要问题亟待解决。有时候，这让我很难用线性的方式来沟通优先级，让我们都在同一页上，理性地合作做同一件事。考虑到该团队在这个项目之前没有合作过，对我们各自不同的工作和沟通方式都是刚刚了解，所以有相当多的 "沟通不足 "需要我们改进。
#### 个人补充
##### 新团队能做到现在这样非常了不起。沟通、沟通、还是沟通
